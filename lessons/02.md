# Digitando em campos e clicando em elementos

Uma das tarefas mais comuns quando se trata de testar aplicaÃ§Ãµes web Ã© a interaÃ§Ã£o com campos de texto, tais como os campos de nome, sobrenome, email, telefone e Ã¡rea de texto da aplicaÃ§Ã£o CAC TAT.

Para lidar com tais campos, o Cypress oferece uma funcionalidade chamada [`.type()`](https://on.cypress.io/type), a qual a traduÃ§Ã£o Ã© `digitar`.

AlÃ©m disso, depois de digitarmos em campos, normalmente, temos que clicar em algum botÃ£o, por exemplo, para que uma aÃ§Ã£o seja disparada, tal como o envio dos dados de um formulÃ¡rio.

Para isso, o Cypress oferece a funcionalidade [`.click()`](https://on.cypress.io/click).

Mas antes de nos aprofundarmos nos comandos `.type()` e `.click()`, deixe-me apresentar o comando [`cy.get()`](https://on.cypress.io/get).

O comando `cy.get()` Ã© um dos comandos mais utilizados, pois nos permite identificar os elementos com os quais queremos interagir ou fazer verificaÃ§Ãµes.

A maneira mais comum de usar o comando `cy.get()` Ã© passÃ¡-lo um seletor CSS como um argumento (como uma _string_), que identifica um (ou mais) elemento(s), para posterior aÃ§Ã£o ou verificaÃ§Ã£o. Por exemplo, `cy.get('[data-test="avatar"]')`.

> **Importante:** O Cypress possui [mecanismos de re-tentativas](https://docs.cypress.io/guides/core-concepts/retry-ability) de execuÃ§Ã£o de comandos. Ou seja, caso o Cypress nÃ£o consiga identificar um elemento por seu seletor CSS (ao usar o comando `cy.get()`, por exemplo), ele tentarÃ¡ novamente (por um determinado perÃ­odo de tempo), antes de falhar o teste.

Agora, vamos dar uma olhada em algo que vocÃª jÃ¡ fez na liÃ§Ã£o anterior, usando o comando `.should()`, mas olhando de uma forma mais abrangente.

## [Encadeamento de comandos](https://docs.cypress.io/guides/core-concepts/introduction-to-cypress#Chains-of-Commands)

No Cypress, ao contrÃ¡rio de outras ferramentas de automaÃ§Ã£o de teste, a maioria dos comandos podem ser encadeados.

Ou seja, em vez de armazenar o retorno de um `cy.get()` em uma variÃ¡vel para uso posterior, vocÃª encadeia comandos Ã  ele, como `.should()`, `.type()` ou `. click()`.

Por exemplo: `cy.get('input[type="text"]').type('OlÃ¡ mundo!')`.

PorÃ©m, a coisa nÃ£o para por aÃ­.

O comando `cy.get()` passa adiante ao prÃ³ximo comando o elemento encontrado. AlÃ©m disso, outros comandos, tais como `.type()` e `.click()` (dentre outros), tambÃ©m passam adiante o mesmo elemento, possibilitando encadearmos novos comandos, por exemplo, para fazer uma verificaÃ§Ã£o.

Algo como o seguinte:

```js
cy.get('input[type="text"]')
  .type('OlÃ¡ mundo!')
  .should('have.value', 'OlÃ¡ mundo!')

```

Podemos atÃ© mesmo fazer verificaÃ§Ãµes intermediÃ¡rias.

Por exemplo, antes de digitar no campo, podemos verificar se tal elemento estÃ¡ visÃ­vel.

```js
cy.get('input[type="text"]')
  .should('be.visible')
  .type('OlÃ¡ mundo!')
  .should('have.value', 'OlÃ¡ mundo!')
  
```

**Obs.:** Embora vocÃª possa encadear um comando `.should()` ao `.type()`, idealmente, vocÃª nÃ£o deveria, pois [as aÃ§Ãµes devem estar no final das cadeias, nÃ£o no meio](https://docs.cypress.io/guides/core-concepts/retry-ability#Actions-should-be-at-the-end-of-chains-not-the-middle). Isso ocorre porque [apenas comandos do tipo _query_ sÃ£o re-tentados](https://docs.cypress.io/guides/core-concepts/retry-ability#Only-queries-are-retried).

> Durante os exercÃ­cios, eu irei encadear um comando `.should()` apÃ³s um `.type()` (ou outro comando de aÃ§Ã£o), mas isso ocorre apenas porque a aplicaÃ§Ã£o CAC TAT Ã© uma aplicaÃ§Ã£o de exemplo, nÃ£o uma aplicaÃ§Ã£o real.
>
> ğŸ‘¨â€ğŸ« Leia a [documentaÃ§Ã£o oficial](https://docs.cypress.io/api/table-of-contents#Commands) para mais detalhes sobre os diferentes tipos de comandos que o Cypress oferece (`query`, `assertion`, `action` e `outros`).
>
> ğŸ‘¨â€ğŸ« Uma alternativa melhor para a cadeia de comandos acima seria a seguinte.

```js
cy.get('input[type="text"]')
  .as('textField')
  .should('be.visible')
  .type('OlÃ¡ mundo!')
cy.get('@textField')
  .should('have.value', 'OlÃ¡ mundo!')

```

> ğŸ‘¨â€ğŸ« Com os comandos acima, logo apÃ³s obter o `input` do tipo `text`, eu crio uma referÃªncia Ã  ele, dando-lhe um [alias](https://docs.cypress.io/api/commands/as) e deixo o comando `.type()` no final. Depois, obtenho o mesmo elemento pelo seu alias (`cy.get('@textField')`) e entÃ£o executo a verificaÃ§Ã£o final.

Agora que vocÃª leu a documentaÃ§Ã£o oficial do Cypress sobre os comandos `cy.get()`, `.type()`, `.click()` e `.as()` e estÃ¡ familiarizado(a) com as re-rentativas e encadeamento de comandos, que tal alguns exercÃ­cios?

## ExercÃ­cio

1. No teste da liÃ§Ã£o anterior, mova o comando `visit` para um bloco [`beforeEach()`](https://docs.cypress.io/guides/core-concepts/writing-and-organizing-tests#Hooks).
2. Logo abaixo do teste existente, adicione um novo teste, chamado `preenche os campos obrigatÃ³rios e envia o formulÃ¡rio`.
3. O teste deve combinar os comandos `cy.get()`, `.type()` e `.click()`, para digitar alguns dados nos campos **Nome**, **Sobrenome**, **E-mail** e **Como podemos te ajudar? Algum elogio ou feedback para nÃ³s?**, alÃ©m de clicar no botÃ£o **Enviar**.
4. ApÃ³s o clique, uma mensagem de sucesso deve ser exibida (esta mensagem deve estar contida em um elemento com a classe `success` ğŸ™Š). Verifique se tal mensagem estÃ¡ visÃ­vel (`.should('be.visible')`).
5. Execute o novo teste na _Cypress App_ e quando o mesmo estiver passando siga adiante para o exercÃ­cio extra 1.

> ğŸ‘¨â€ğŸ« Se vocÃª precisa de "uma mÃ£o" com seletores CSS antes de resolver o exercÃ­cio, recomendo assistir a seguinte [live](https://youtu.be/HxJvAL4CHYE) que fiz no [Canal TAT no YouTube](https://www.youtube.com/c/talkingabouttesting) em MarÃ§o de 2021.
>
> Ou entÃ£o, me veja resolvendo o problema, onde explico cada detalhe.

## ExercÃ­cio extra 1

No objeto de `options` que podemos passar ao comando `.type()`, Ã© possÃ­vel sobrescrever o `delay` padrÃ£o por outro valor (em milissegundos).

Quando o valor `0` Ã© passado, a digitaÃ§Ã£o no campo acontece de forma imediata.

Portanto, experimente digitar um texto longo na Ã¡rea de texto, passando como segundo argumento ao comando `.type()` um objeto (`{}`), com a propriedade `delay` com valor `0`.

> ğŸ‘¨â€ğŸ« Para mais detalhes sobre a opÃ§Ã£o `delay`, leia a [documentaÃ§Ã£o oficial do Cypress](https://docs.cypress.io/api/commands/type#Arguments).

Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o prÃ³ximo exercÃ­cio.

## ExercÃ­cio extra 2

1. Crie um teste chamado `exibe mensagem de erro ao submeter o formulÃ¡rio com um email com formataÃ§Ã£o invÃ¡lida`
2. Tal teste deve verificar que uma mensagem Ã© exibida em um elemento com a classe `error` ğŸ™Š
3. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o prÃ³ximo exercÃ­cio

## ExercÃ­cio extra 3

Visto que o campo de telefone sÃ³ aceita nÃºmeros, crie um teste para validar que, se um valor nÃ£o-numÃ©rico for digitado, seu valor continuarÃ¡ vazio.

> ğŸ‘¨â€ğŸ« Pra te ajudar com a verificaÃ§Ã£o do valor de um input, recomendo a leitura do [seguinte conteÃºdo](https://docs.cypress.io/faq/questions/using-cypress-faq#How-do-I-get-an-inputs-value), direto da documentaÃ§Ã£o oficial do Cypress.
> O primeiro exemplo deve ser o suficiente.
>
> Ou entÃ£o, me veja resolvendo o problema.

Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o prÃ³ximo exercÃ­cio.

## ExercÃ­cio extra 4

1. Crie um teste chamado `exibe mensagem de erro quando o telefone se torna obrigatÃ³rio mas nÃ£o Ã© preenchido antes do envio do formulÃ¡rio`
2. Tal teste deve verificar que uma mensagem Ã© exibida em um elemento com a classe `error`
3. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o prÃ³ximo exercÃ­cio

## ExercÃ­cio extra 5

Uma funcionalidade que pode ser usada em conjunto com comando o `.type()`, Ã© o [`.clear()`](https://on.cypress.io/clear), o qual limpa um campo, para posterior digitaÃ§Ã£o, por exemplo.

1. Portanto, crie um teste chamado `preenche e limpa os campos nome, sobrenome, email e telefone`
2. Tal teste deve verificar o valor (`value`) apÃ³s a digitaÃ§Ã£o (`.type(...).should('have.value', 'valor-aqui')`) e apÃ³s a limpeza do campo (`.clear().should('have.value', '')`)
3. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o prÃ³ximo exercÃ­cio

## ExercÃ­cio extra 6

1. Crie um novo teste chamado `exibe mensagem de erro ao submeter o formulÃ¡rio sem preencher os campos obrigatÃ³rios`.
2. O teste deve simplesmente acessar a aplicaÃ§Ã£o e clicar no botÃ£o **Enviar**
3. Tal teste deve verificar que uma mensagem Ã© exibida em um elemento com a classe `error`
4. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o prÃ³ximo exercÃ­cio

## ExercÃ­cio extra 7 - [Comandos customizados](https://docs.cypress.io/api/cypress-api/custom-commands)

No mundo de testes automatizados com Cypress, podemos fazer uso de comandos customizados para evitar duplicaÃ§Ã£o de cÃ³digo.

Escrevi sobre o assunto em Fevereiro de 2021, em um conteÃºdo chamado [Como criar comandos customizados com Cypress](https://talkingabouttesting.com/2021/02/10/como-criar-comandos-customizados-com-cypress/). Recomendo a leitura.

AlÃ©m disso, em Abril de 2021, fiz um vÃ­deo para a _playlist_ `cy.handsOn()` do Canal TAT no YouTube, chamado [Cypress Page Object vs GUI Custom Commands](https://youtu.be/1OkfwHUJ-fk), no qual brevemente comento sobre minha preferÃªncia por comandos customizados em vez do padrÃ£o _Page Objects_ quando se trata de testes automatizados escritos com Cypress.

Teu exercÃ­cio Ã©:

1. Criar um teste chamado `envia o formuÃ¡rio com sucesso usando um comando customizado`
2. Tal teste deve fazer uso de um comando chamado `fillMandatoryFieldsAndSubmit`, o qual deve ser implementado no arquivo `cypress/support/commands.js`

> ğŸ‘¨â€ğŸ« Sugiro que vocÃª experimente diferentes implementaÃ§Ãµes para o mesmo comando (por exemplo, um comando que nÃ£o recebe nenhum argumento; um comando que recebe um objeto como argumento; um comando que recebe um objeto como argumento, com valores padrÃ£o).

3. Deve haver a verificaÃ§Ã£o de que a mensagem de sucesso Ã© exibida
4. Por fim, execute o novo teste na _Cypress App_ e quando o mesmo estiver passando, siga adiante para o prÃ³ximo exercÃ­cio

## ExercÃ­cio extra 8

Outra forma de identificar elementos (para, por exemplo, clicar neles apÃ³s sua definiÃ§Ã£o) Ã© o uso da funcionalidade [`cy.contains()`](https://on.cypress.io/contains).

Com o comando `cy.contains()`, alÃ©m de um seletor CSS, vocÃª pode passar como segundo argumento um texto, o qual deve estar contido no elemento o qual vocÃª deseja identificar.

Por exemplo, se vocÃª tivesse o seguinte elemento HTML `<a href="https://example.com">Clique aqui!</a>`, vocÃª poderia identificÃ¡-lo usando o seguinte comando `cy.contains('a', 'Clique aqui!')`.

Teu exercÃ­co Ã© alterar todos os locais onde identificamos o botÃ£o para posterior clique, onde em vez de identificarmos tal elemento com o `cy.get()`, iremos usar o `cy.contains()`.

> ğŸ‘¨â€ğŸ« Lembre-se de executar todos os testes apÃ³s a alteraÃ§Ã£o para garantir que suas mudanÃ§as nÃ£o quebraram nada.

## ConteÃºdos sugeridos

Nos conteÃºdos listados abaixo, faÃ§o diferentes usos do comando `.type()`.

- [Como preencher e submeter formulÃ¡rios com Cypress](https://talkingabouttesting.com/2021/02/05/como-preencher-e-submeter-formularios-com-cypress/)
- [Como proteger dados sensÃ­veis com Cypress](https://talkingabouttesting.com/2021/02/09/como-proteger-dados-sensiveis-com-cypress/)
- [3 maneiras de testar funcionalidades de busca com Cypress.io](https://youtu.be/bqz7sv-LgrM)
- [Testando busca com auto-complete usando Cypress](https://youtu.be/3qUq0XkPwts)
- [Como testar campos de data com Cypress](https://youtu.be/wiDOdfmuR2o)

Espero que goste dos conteÃºdos!

## Mostre ao mundo o que vocÃª aprendeu

Para mostrar Ã  sua rede profissional o que vocÃª aprendeu atÃ© agora, poste o seguinte no LinkedIn.

> Estou fazendo o curso "Cypress, do Zero Ã  Nuvem" da escola online Talking About Testing, onde aprendi sobre encadeamento de comandos, re-tentativas e alguns dos comandos mais comuns do Cypress. #TalkingAboutTesting #EscolaTAT #CypressDoZeroANuvem #Cypress

**Obs.:** Lembre-se de me marcar em sua postagem. [Aqui estÃ¡ meu perfil no LinkedIn](https://www.linkedin.com/in/walmyr-lima-e-silva-filho).

___

ParabÃ©ns! Vamos para a [liÃ§Ã£o 3](./03.md) para aprender como selecionar opÃ§Ãµes em campos de seleÃ§Ã£o suspensa.
